<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Spyfall</title>
  <link rel="stylesheet" type="text/css" href="/tacit.min.css"/>
</head>
<script>
var timer;

document.addEventListener("DOMContentLoaded", function(event) {
  updateCountdown();
  timer = setInterval(updateCountdown, 1000);
});

function updateCountdown() {
  var d = new Date().getTime();
  var timestamp = Math.floor(d / 1000);
  var diff = {{ .Countdown }} - timestamp;
  if (diff < 0) {
    cd.innerHTML = "0:00";
    clearInterval(timer);
    return;
  }

  var cd = document.getElementById("countdown");
  var minute = Math.floor(diff / 60);
  var seconds = diff - (minute * 60);
  seconds = seconds < 10 ? "0" + seconds : seconds; // add leading 0

  cd.innerHTML = minute + ":" + seconds;
}

</script>
<style>
ul {
  margin: 0;
  list-style-type: none;
  display: inline-flex;
}

figure {
     position: relative;
}
figure img {
    display: block;
}
figcaption {
    background: rgba(0, 0, 0, 0.5);
    color: #FFF;
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding-left: 10px;
    font-size: 30px;
    line-height: 40px;
}

.currentLocation {
  color: red;
}

</style>
<body>
  <section>
  <a href="/"><h1>Spyfall</h1></a>
  <div id="countdown"></div>
  {{ if .Spy }}
    <p>You are the Spy</p>
  {{ else }}
    {{$l := index .Cards .Location}}
    <p>Locations: {{$l.Name}}</p>
  {{ end }}
  <ul>
    {{range $index, $element := .Cards}}
    <li>
      <figure>
        <img src="/cards/{{.Path}}" width="960" height="600">
        {{if $.Spy }}
        <figcaption>{{.Name}}</figcaption>
        {{else if eq $index $.Location }}
        <figcaption class="currentLocation">{{.Name}}</figcaption>
        {{ else }}
        <figcaption>{{.Name}}</figcaption>
        {{end}}
      </figure>
    </li>
    {{end}}
  </ul>
  </section>
</body>
</html>
